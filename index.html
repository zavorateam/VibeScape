<!DOCTYPE html>
<html lang="ru">
    <head>
        <script class="injected-ffc2e83d85" src="./index.js"></script>
        <meta charset="utf-8">
        <meta content="width=device-width, initial-scale=1.0" name="viewport">
        <title>Immersive Audio Visualizer</title>
        <script src="https://cdn.tailwindcss.com"></script>
        <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,1,0" rel="stylesheet">
        <style>
                body { margin: 0; overflow: hidden; background-color: #020203; font-family: 'Segoe UI', sans-serif; user-select: none; }
                
                /* Layering */
                #bg-canvas { position: absolute; inset: 0; z-index: 0; }
                #main-canvas { position: absolute; inset: 0; z-index: 10; pointer-events: none; }
                
                /* UI Layer */
                #ui-layer { 
                    position: absolute; 
                    inset: 0; 
                    z-index: 50; 
                    transition: opacity 0.6s ease, transform 0.6s cubic-bezier(0.34, 1.56, 0.64, 1);
                }
                
                .ui-hidden {
                    opacity: 0 !important;
                    pointer-events: none !important;
                    transform: scale(1.1);
                }

                /* Glassmorphism */
                .glass-btn {
                    background: rgba(255, 255, 255, 0.05);
                    backdrop-filter: blur(12px);
                    -webkit-backdrop-filter: blur(12px);
                    border: 1px solid rgba(255, 255, 255, 0.1);
                    transition: all 0.2s ease;
                }
                .glass-btn:hover {
                    background: rgba(255, 255, 255, 0.15);
                    transform: scale(1.05);
                }
                .glass-btn:active { transform: scale(0.95); }

                .glass-panel {
                    background: rgba(10, 10, 15, 0.75);
                    backdrop-filter: blur(24px);
                    border: 1px solid rgba(255, 255, 255, 0.08);
                    box-shadow: 0 20px 50px rgba(0,0,0,0.8);
                }

                input[type="file"] { display: none; }
                
                /* Radio Input Animation */
                .radio-input-wrapper {
                    width: 0;
                    opacity: 0;
                    overflow: hidden;
                    transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
                }
                
                .radio-active .radio-input-wrapper {
                    width: 240px; 
                    opacity: 1;
                    margin-left: 8px;
                    padding-right: 4px;
                }
                
                .radio-active .file-label { display: none; }

                /* Hint Animation */
                @keyframes pulse-fade {
                    0%, 100% { opacity: 0.3; transform: translateY(0); }
                    50% { opacity: 0.7; transform: translateY(-2px); }
                }
                .hint-text { animation: pulse-fade 3s infinite; }
        </style>
        <style>*, ::before, ::after{--tw-border-spacing-x:0;--tw-border-spacing-y:0;--tw-translate-x:0;--tw-translate-y:0;--tw-rotate:0;--tw-skew-x:0;--tw-skew-y:0;--tw-scale-x:1;--tw-scale-y:1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness:proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:rgb(59 130 246 / 0.5);--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }::backdrop{--tw-border-spacing-x:0;--tw-border-spacing-y:0;--tw-translate-x:0;--tw-translate-y:0;--tw-rotate:0;--tw-skew-x:0;--tw-skew-y:0;--tw-scale-x:1;--tw-scale-y:1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness:proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:rgb(59 130 246 / 0.5);--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }/* ! tailwindcss v3.4.17 | MIT License | https://tailwindcss.com */*,::after,::before{box-sizing:border-box;border-width:0;border-style:solid;border-color:#e5e7eb}::after,::before{--tw-content:''}:host,html{line-height:1.5;-webkit-text-size-adjust:100%;-moz-tab-size:4;tab-size:4;font-family:ui-sans-serif, system-ui, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji";font-feature-settings:normal;font-variation-settings:normal;-webkit-tap-highlight-color:transparent}body{margin:0;line-height:inherit}hr{height:0;color:inherit;border-top-width:1px}abbr:where([title]){-webkit-text-decoration:underline dotted;text-decoration:underline dotted}h1,h2,h3,h4,h5,h6{font-size:inherit;font-weight:inherit}a{color:inherit;text-decoration:inherit}b,strong{font-weight:bolder}code,kbd,pre,samp{font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;font-feature-settings:normal;font-variation-settings:normal;font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}table{text-indent:0;border-color:inherit;border-collapse:collapse}button,input,optgroup,select,textarea{font-family:inherit;font-feature-settings:inherit;font-variation-settings:inherit;font-size:100%;font-weight:inherit;line-height:inherit;letter-spacing:inherit;color:inherit;margin:0;padding:0}button,select{text-transform:none}button,input:where([type=button]),input:where([type=reset]),input:where([type=submit]){-webkit-appearance:button;background-color:transparent;background-image:none}:-moz-focusring{outline:auto}:-moz-ui-invalid{box-shadow:none}progress{vertical-align:baseline}::-webkit-inner-spin-button,::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}summary{display:list-item}blockquote,dd,dl,figure,h1,h2,h3,h4,h5,h6,hr,p,pre{margin:0}fieldset{margin:0;padding:0}legend{padding:0}menu,ol,ul{list-style:none;margin:0;padding:0}dialog{padding:0}textarea{resize:vertical}input::placeholder,textarea::placeholder{opacity:1;color:#9ca3af}[role=button],button{cursor:pointer}:disabled{cursor:default}audio,canvas,embed,iframe,img,object,svg,video{display:block;vertical-align:middle}img,video{max-width:100%;height:auto}[hidden]:where(:not([hidden=until-found])){display:none}.pointer-events-none{pointer-events:none}.absolute{position:absolute}.relative{position:relative}.bottom-12{bottom:3rem}.left-0{left:0px}.left-1\/2{left:50%}.top-8{top:2rem}.z-10{z-index:10}.mx-2{margin-left:0.5rem;margin-right:0.5rem}.mr-2{margin-right:0.5rem}.flex{display:flex}.h-10{height:2.5rem}.h-12{height:3rem}.h-16{height:4rem}.h-8{height:2rem}.h-9{height:2.25rem}.h-full{height:100%}.h-screen{height:100vh}.w-10{width:2.5rem}.w-12{width:3rem}.w-16{width:4rem}.w-9{width:2.25rem}.w-\[1px\]{width:1px}.w-auto{width:auto}.w-full{width:100%}.w-screen{width:100vw}.min-w-0{min-width:0px}.max-w-\[95vw\]{max-width:95vw}.flex-1{flex:1 1 0%}.shrink-0{flex-shrink:0}.-translate-x-1\/2{--tw-translate-x:-50%;transform:translate(var(--tw-translate-x), var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.cursor-pointer{cursor:pointer}.flex-col{flex-direction:column}.items-start{align-items:flex-start}.items-center{align-items:center}.justify-center{justify-content:center}.justify-between{justify-content:space-between}.gap-2{gap:0.5rem}.gap-3{gap:0.75rem}.rounded-full{border-radius:9999px}.border{border-width:1px}.border-white\/10{border-color:rgb(255 255 255 / 0.1)}.border-white\/5{border-color:rgb(255 255 255 / 0.05)}.bg-black\/30{background-color:rgb(0 0 0 / 0.3)}.bg-rose-600{--tw-bg-opacity:1;background-color:rgb(225 29 72 / var(--tw-bg-opacity, 1))}.bg-white{--tw-bg-opacity:1;background-color:rgb(255 255 255 / var(--tw-bg-opacity, 1))}.bg-white\/10{background-color:rgb(255 255 255 / 0.1)}.bg-white\/5{background-color:rgb(255 255 255 / 0.05)}.p-2{padding:0.5rem}.p-8{padding:2rem}.px-4{padding-left:1rem;padding-right:1rem}.px-6{padding-left:1.5rem;padding-right:1.5rem}.py-2{padding-top:0.5rem;padding-bottom:0.5rem}.pr-4{padding-right:1rem}.text-3xl{font-size:1.875rem;line-height:2.25rem}.text-\[10px\]{font-size:10px}.text-lg{font-size:1.125rem;line-height:1.75rem}.text-xl{font-size:1.25rem;line-height:1.75rem}.text-xs{font-size:0.75rem;line-height:1rem}.font-bold{font-weight:700}.font-medium{font-weight:500}.uppercase{text-transform:uppercase}.tracking-\[0\.2em\]{letter-spacing:0.2em}.tracking-\[0\.3em\]{letter-spacing:0.3em}.tracking-wider{letter-spacing:0.05em}.text-black{--tw-text-opacity:1;color:rgb(0 0 0 / var(--tw-text-opacity, 1))}.text-rose-200\/80{color:rgb(254 205 211 / 0.8)}.text-sky-200\/80{color:rgb(186 230 253 / 0.8)}.text-white{--tw-text-opacity:1;color:rgb(255 255 255 / var(--tw-text-opacity, 1))}.text-white\/40{color:rgb(255 255 255 / 0.4)}.text-white\/70{color:rgb(255 255 255 / 0.7)}.text-white\/80{color:rgb(255 255 255 / 0.8)}.opacity-0{opacity:0}.shadow-\[0_0_25px_rgba\(255\2c 255\2c 255\2c 0\.15\)\]{--tw-shadow:0 0 25px rgba(255,255,255,0.15);--tw-shadow-colored:0 0 25px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow)}.shadow-lg{--tw-shadow:0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);--tw-shadow-colored:0 10px 15px -3px var(--tw-shadow-color), 0 4px 6px -4px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow)}.outline-none{outline:2px solid transparent;outline-offset:2px}.backdrop-blur-md{--tw-backdrop-blur:blur(12px);-webkit-backdrop-filter:var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia);backdrop-filter:var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia)}.transition-all{transition-property:all;transition-timing-function:cubic-bezier(0.4, 0, 0.2, 1);transition-duration:150ms}.transition-colors{transition-property:color, background-color, border-color, fill, stroke, -webkit-text-decoration-color;transition-property:color, background-color, border-color, text-decoration-color, fill, stroke;transition-property:color, background-color, border-color, text-decoration-color, fill, stroke, -webkit-text-decoration-color;transition-timing-function:cubic-bezier(0.4, 0, 0.2, 1);transition-duration:150ms}.transition-opacity{transition-property:opacity;transition-timing-function:cubic-bezier(0.4, 0, 0.2, 1);transition-duration:150ms}.transition-transform{transition-property:transform;transition-timing-function:cubic-bezier(0.4, 0, 0.2, 1);transition-duration:150ms}.duration-700{transition-duration:700ms}.hover\:scale-105:hover{--tw-scale-x:1.05;--tw-scale-y:1.05;transform:translate(var(--tw-translate-x), var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.hover\:border-white\/20:hover{border-color:rgb(255 255 255 / 0.2)}.hover\:bg-rose-500:hover{--tw-bg-opacity:1;background-color:rgb(244 63 94 / var(--tw-bg-opacity, 1))}.hover\:bg-rose-500\/20:hover{background-color:rgb(244 63 94 / 0.2)}.hover\:text-rose-200:hover{--tw-text-opacity:1;color:rgb(254 205 211 / var(--tw-text-opacity, 1))}.focus\:border-rose-500\/50:focus{border-color:rgb(244 63 94 / 0.5)}.active\:scale-95:active{--tw-scale-x:.95;--tw-scale-y:.95;transform:translate(var(--tw-translate-x), var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.group:hover .group-hover\:bg-white\/10{background-color:rgb(255 255 255 / 0.1)}.group:hover .group-hover\:text-white{--tw-text-opacity:1;color:rgb(255 255 255 / var(--tw-text-opacity, 1))}
        </style>
    </head>
    <body class="text-white h-screen w-screen">
        <!-- Audio Engine -->
        <audio crossorigin="anonymous" id="audio-element"></audio>
        <!-- Visuals -->
        <canvas id="bg-canvas" width="1056" height="722"></canvas>
        <canvas id="main-canvas" width="1056" height="722"></canvas>
        <!-- UI -->
        <div class="flex flex-col justify-between p-8 h-full w-full" id="ui-layer">
            <!-- Header Info -->
            <div class="flex justify-between items-start">
                <div class="flex flex-col gap-3">
                    <div class="flex items-center gap-3 text-sky-200/80">
                        <span class="material-symbols-outlined text-xl">public</span>
                        <span class="text-xs font-bold tracking-[0.2em]" id="geo-text">ПОИСК ГЕО...</span>
                    </div>
                    <div class="flex items-center gap-3 text-rose-200/80">
                        <span class="material-symbols-outlined text-xl">graphic_eq</span>
                        <span class="text-xs font-bold tracking-[0.2em]" id="genre-text">ОЖИДАНИЕ</span>
                    </div>
                </div>
                <!-- Top Controls -->
                <div class="flex gap-3">
                    <button class="glass-btn w-12 h-12 rounded-full flex items-center justify-center group" onclick="event.stopPropagation(); toggleUI()" title="Скрыть интерфейс">
                    <span class="material-symbols-outlined text-white/70 group-hover:text-white">visibility_off</span>
                    </button>
                    <button class="glass-btn w-12 h-12 rounded-full flex items-center justify-center group" onclick="event.stopPropagation(); toggleMode()" title="Сменить режим">
                    <span class="material-symbols-outlined text-white/70 group-hover:text-white" id="mode-icon">equalizer</span>
                    </button>
                </div>
            </div>
            <!-- Player Controls -->
            <div class="absolute bottom-12 left-1/2 -translate-x-1/2 w-auto max-w-[95vw]">
            <div class="glass-panel p-2 pr-4 rounded-full flex items-center gap-2 transition-all hover:border-white/20 relative" id="control-bar">
            <!-- Play Toggle -->
            <button class="w-16 h-16 rounded-full bg-white text-black flex items-center justify-center hover:scale-105 active:scale-95 transition-transform shadow-[0_0_25px_rgba(255,255,255,0.15)] z-10 shrink-0" id="play-btn" onclick="event.stopPropagation(); togglePlay()">
            <span class="material-symbols-outlined text-3xl" id="play-icon">play_arrow</span>
            </button>
            <!-- Divider -->
            <div class="h-8 w-[1px] bg-white/10 mx-2"></div>
            <!-- File Upload -->
            <label class="flex items-center gap-3 cursor-pointer group file-label p-2" onclick="event.stopPropagation()">
            <div class="w-10 h-10 rounded-full bg-white/5 flex items-center justify-center group-hover:bg-white/10 transition-colors">
            <span class="material-symbols-outlined text-white/70">upload_file</span>
            </div>
            <div class="flex flex-col mr-2">
            <span class="text-[10px] text-white/40 font-bold tracking-wider uppercase">Файл</span>
            <span class="text-xs font-medium text-white/80 group-hover:text-white">Загрузить MP3</span>
            </div>
            <input accept="audio/*" onchange="handleFile(this.files[0])" type="file">
            </label>
            <!-- Radio Toggle -->
            <div class="flex items-center relative group" id="radio-container">
            <button class="w-10 h-10 rounded-full bg-white/5 flex items-center justify-center hover:bg-rose-500/20 hover:text-rose-200 transition-colors shrink-0" onclick="event.stopPropagation(); toggleRadioInput()" title="Интернет Радио">
            <span class="material-symbols-outlined text-white/70">radio</span>
            </button>
            <!-- Expanding Input for URL -->
            <div class="radio-input-wrapper flex items-center gap-2">
            <input class="bg-white/5 border border-white/10 rounded-full px-4 py-2 text-xs text-white outline-none focus:border-rose-500/50 flex-1 min-w-0" id="stream-url" onkeydown="checkRadioEnter(event)" placeholder="Ссылка на поток..." type="text">
            <button class="w-9 h-9 rounded-full bg-rose-600 hover:bg-rose-500 flex items-center justify-center transition-colors shrink-0 shadow-lg border border-white/10" onclick="playStream()" title="Запустить">
            <span class="material-symbols-outlined text-lg">play_arrow</span>
            </button>
            </div>
            </div>
            </div>
            </div>
        </div>
        <!-- Restore Hint -->
        <div class="absolute top-8 left-0 w-full flex justify-center pointer-events-none opacity-0 transition-opacity duration-700" id="restore-hint">
            <span class="bg-black/30 text-white/40 px-6 py-2 rounded-full text-[10px] tracking-[0.3em] backdrop-blur-md hint-text border border-white/5 uppercase">Нажмите любую клавишу</span>
        </div>
        <script src="./visualiser.js"></script>
    </body>
</html>